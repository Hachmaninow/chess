<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>Your page title here :)</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Font
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <link rel="stylesheet" href="css/chessboard-0.3.0.css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="images/favicon.png">

</head>
<body>

  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div class="container">
    <div class="row">
      <div class="eight columns" style="margin-top: 5%">
        <div id="board"></div>
      </div>
      <div class="four columns" style="margin-top: 5%">
        <div id="notation">
          1. e3 f6
        </div>
      </div>
    </div>

    <div class="row">
      <div class="two columns">
        <p>Status: <span id="status"></span></p>
      </div>
      <div class="six columns">
        <p>FEN: <span id="fen"></span></p>
      </div>
    </div>

    <div class="row">
      <div class="twelve columns">
        <p>PGN: <span id="pgn"></span></p>
      </div>
    </div>
  </div>

  <script src="js/chess.min.js"></script>
  <script src="js/jquery-2.1.4.min.js"></script>
  <script src="js/chessboard-0.3.0.js"></script>
  <script src="js/chess.js"></script>

  <script>
    var init = function() {

      //--- start example JS ---
      var board,
          game = new Chess(),
          statusEl = $('#status'),
          fenEl = $('#fen'),
          pgnEl = $('#pgn');

      // do not pick up pieces if the game is over
      // only pick up pieces for the side to move
      var onDragStart = function(source, piece, position, orientation) {
        if (game.game_over() === true ||
            (game.turn() === 'w' && piece.search(/^b/) !== -1) ||
            (game.turn() === 'b' && piece.search(/^w/) !== -1)) {
          return false;
        }
      };

      var onDrop = function(source, target) {
        // see if the move is legal
        var move = game.move({
          from: source,
          to: target,
          promotion: 'q' // NOTE: always promote to a queen for example simplicity
        });

        // illegal move
        if (move === null) return 'snapback';

        updateStatus();
      };

      // update the board position after the piece snap
      // for castling, en passant, pawn promotion
      var onSnapEnd = function() {
        board.position(game.fen());
      };

      var updateStatus = function() {
        var status = '';

        var moveColor = 'White';
        if (game.turn() === 'b') {
          moveColor = 'Black';
        }

        // checkmate?
        if (game.in_checkmate() === true) {
          status = 'Game over, ' + moveColor + ' is in checkmate.';
        }

        // draw?
        else if (game.in_draw() === true) {
          status = 'Game over, drawn position';
        }

        // game still on?
        else {
          status = moveColor + ' to move';

          // check?
          if (game.in_check() === true) {
            status += ', ' + moveColor + ' is in check';
          }
        }

        statusEl.html(status);
        fenEl.html(game.fen());
        pgnEl.html(game.pgn());
      };

      var cfg = {
        draggable: true,
        position: 'start',
        onDragStart: onDragStart,
        onDrop: onDrop,
        onSnapEnd: onSnapEnd
      };
      board = ChessBoard('board', cfg);

      updateStatus();

      $("body #notation move").click(function(){
        var fen = $(this).attr("fen");
        board.position(fen, false);
        var r = game.load(fen);
        console.log("load: " + r);

        console.log("validate: " + game.validate_fen(fen).error)
      });
    };

    $(document).ready(init);

  </script>
</body>
</html>
